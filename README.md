Legendary Item - простенький мод, который добавляет множество артефактов "Властелина колец" в Minecraft. В основном это броня и оружие, а также аркенстон и сильмарилль. Почти все оружия имеют особый рендеринг: в инвентаре они имеют одну текстуру, а в руке от первого и третьего лица - другую, увеличенную. Так оружие смотрится эпичнее. Мод рассматривается как тематические дополнение к моду "Властелин колец", хотя мод независим и не требует установки каких-либо других модов.

Приведённая ниже документация будет полезна как разработчикам, так и мне самому из будущего. Сведения, гайды, подводные камни, советы и всё такое. Обязательно прочитайте, здесь есть уникальная информация, которой больше нигде нет.

<h2> Общая информация </h2>

Этот репозиторий содержит множество папок, каждая из них - это проект Gradle, который должен быть открыт через IntelliJ IDEA или импортирован в Eclipse IDE.

| Версия         | Синтаксис Java  | Версия Gradle | Плагин сборки                     | Версия JDK                  |
|----------------|-----------------|---------------|-----------------------------------|-----------------------------|
| 1.3.2 - 1.6.4  | 6               | 7.6           | Voldeloom 2.4                     | Eclipse Temurin 11.0.20     |
| 1.7.10         | 8               | 8.4           | ForgeGradle Anatawa12's 1.2-1.1.+ | Eclipse Temurin 1.8.0_392   |
| 1.8.9          | 8               | 2.14          | ForgeGradle 2.1-SNAPSHOT          | Eclipse Temurin 1.8.0_392   |
| 1.9.4 - 1.11.2 | 8               | 2.14          | ForgeGradle 2.2-SNAPSHOT          | Eclipse Temurin 1.8.0_392   |
| 1.12.2 - 1.16.5| 8               | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 1.8.0_392   |
| 1.17.1         | 16              | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 16.0.2      |
| 1.18.2 и новее | 17              | 8.1.1         | ForgeGradle 6.0.14,6.2            | Eclipse Temurin 17.0.8      |

Обязательно проконтролируйте, чтобы ваш синтаксис Java и ваша JDK были такими, как сказано выше. Ваша IDE и переменные среды вашей ОС должны быть правильно сконфигурированы, иначе ничего не будет работать.

* JDK, сконфигурированный в IDE, отвечает за то, какие конструкции языка вы можете использовать в коде мода и какой на выходе получится байткод (который должен быть совместим с ожиданиями Forge).
* Синтаксис, сконфигурированный в IDE, отвечает за то, какие конструкции языка вы можете использовать (чтобы случайно не получить на выходе байткод, который будет нечитаемым и крашнет Forge). В некоторых случаях вы можете выбрать более новую JDK и более старый синтаксис, чтобы ограничить себя.
* JDK, сконфигурированный в переменных средах ОС, отвечает за то, какой джавой будет запущена сборка мода и загрузка среды.
* JDK в Eclipse называется JRE/JDK, в IntelliJ IDEA - SDK. Допуск синтаксиса в Eclipse называется `Compiler Compliance Level`, в IntelliJ IDEA - `Language Level`.

Краткий ответ на вопрос "как и где настраивать эти значения?":

* Переменные среды Windows (у меня Windows 11, так что у вас может что-то отличаться):
  * Первый способ: `ЛКМ по "Мой компьютер" -> Свойства -> Дополнительные параметры системы -> Переменные среды`.
  * Второй способ: `Параметры -> Система -> О системе -> Дополнительные параметры системы -> Переменные среды`.
  * Когда вы всё-таки добрались до переменных сред, создайте там две переменные: `JAVA_HOME` и `Path`. Возможно, они уже существуют, тогда дважды нажмите на них и смотрите, что там написано.
    * В JAVA_HOME должна быть только одна строка, содержащая путь к вашей JDK. У меня это `C:\Users\Hummel009\.jdks\temurin-1.8.0_392`.
	* В Path, помимо других строк, должна быть как минимум одна строка, содержащая путь вашей JDK\bin. У меня это `C:\Users\Hummel009\.jdks\temurin-1.8.0_392\bin`.
* Eclipse IDE:
  * Сверху справа находится лупа, через которую можно попасть куда угодно, введя `Compliance` или `Installed JREs`.
    * В первом случае вас интересует выдача `Compiler`, где вы сверху выставляете число.
	* Во втором случае вас интересует `Installed JREs | Open the preferences dialog`. Там вы можете выбрать и удалить текущую JRE, чтобы потом добавить новую `Standard VM` и указать место на диске, где лежит ваша Java, после чего подтвердить и выбрать её.
  * Если без лупы, то сверху выбираете `Window -> Preferences -> Java` и там выбираете либо `Compiler`, либо `Installed JREs`.
  * Если у вас в среде много проектов, вы можете настроить каждый отдельно. Для этого нажмите слева на проект и сверху пройдите по пути `Project -> Properties` (а не `Window -> Preferences`). Там есть `Java Build Path` и `Java Compiler`.
    * `Java Build Path` настроить сложнее, там необходимо открыть вкладку `Libraries`, нажать на `Module path` и нажать справа `Add Library -> JRE System Library`. Там вы можете указать одну из добавленных ранее в `Installed JREs`.
* IntelliJ IDEA:
  * `Ctrl + Alt + Shift + S` приведёт вас к структуре проекта, где вы настраиваете SDK и Language Level.
  * `Ctrl + Alt + S`, а затем `Build... -> Compiler -> Java Compiler` приведёт вас к настройкам Language Level в среде разработки.
  * `Ctrl + Alt + S`, а затем `Build... -> Build Tools -> Gradle -> Gradle JVM` приведёт вас к настройкам переменных сред в среде разработки. Это на случай, если лень каждый раз править переменные среды ОС.
  * Альтернативные способы добраться до структуры проекта или настроек среды - это нажать на шестерёнку сверху справа и выбрать там `Project Structure` или `Settings`.
  * Ещё один альтернативный способ найти настройки среды - нажать `File -> Settings`.
  
<h2> Гайд по установке и работе </h2>

Собственно, для начала нужно скачать и разархивировать куда-то папку с исходниками. Будем называть это папкой проекта. В ней лежат папки (gradle, src) и различные файлы.

<h3> Версии 1.3.2 - 1.6.4 </h3>

Эти версии вышли более десяти лет назад, и с тех пор все инструменты для разработки уже устарели и недоступны для скачивания. Однако разработку на них вести всё ещё можно, если использовать Voldeloom - аналог ForgeGradle, позволяющий вести разработку на устаревших версиях.

* Для начала, мы импортируем проект Gradle в среду.
  * В случае Eclipse IDE мы импортируем всю папку версии как "существующий Gradle-проект": `File -> Import -> Gradle -> Existing Gradle Project -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA мы открываем всю папку версии как папку проекта. Это можно сделать, открыв IDE и выбрав `File -> Open -> [Выбираете папку]`.
* Чтобы запустить мод из среды, мы должны выполнить Gradle Task `runClient`.
  * В случае Eclipse IDE мы можем открыть поиск (лупа сверху справа) и ввести там `Gradle`, впоследствии нажав на предложенный ответ `Gradle Tasks`. Снизу выбираем `Volde -> runClient`.
  * В случае IntelliJ IDEA у нас есть значок слона сверху справа, нажимая на него, мы попадаем в меню Gradle. Нас там интересует `Volde -> runClient`.
  * Есть и другие способы. Например, открыть консоль Windows в папке версии и ввести там `gradlew runClient`.
  * Если есть проблемы с открытием консоли, можно создать файл с расширением .bat в папке версии, открыть его при помощи блокнота и написать внутри него `gradlew runClient`, после чего запускать процесс двойным тыком.
* Компилировать мод отдельно не нужно - Voldeloom сам компилирует его перед каждым `runClient`.
* Таким образом, после каждого запуска игры из среды новейшая версия вашего мода лежит по пути `среда_разработки/build/libs`. Вообще там лежит два файла, но вас интересует тот, который без приписки `-dev`.

<h3> Версии 1.7.10 - 1.11.2 </h3>

Эти версии вышли достаточно давно, и с тех пор все инструменты для разработки уже устарели. Но, к счастью, они ещё работают. Тем не менее, уже на момент создания они были неидеальны и требовали костыли. Костыли реализуются созданием файлов IDE.

* В папке есть два bat-файла, `setupEclipse` и `setupIdea`. Выбираем нужный, запускаем двойным нажатием ЛКМ по нему, ждём окончания.
  * Под капотом bat-файлов лежат команды консоли Windows, `gradlew setupDecompWorkspace eclipse` и `gradlew setupDecompWorkspace idea`, соответственно. Если желаете взять процесс в свои руки и не полагаться на bat-файлы, можете вместо их запуска открыть в папке проекта консоль Windows и ввести там эти команды руками. Смысл bat-файла, скорее, не в экономии времени, а в напоминании о том, что эта версия требует костыль.
* После окончания генерации среды мы импортируем сгенерированный проект IDE. ***Именно проект IDE!*** Это не проект Gradle.
  * В случае Eclipse IDE мы импортируем всю папку как "существующий Eclipse-проект": `File -> Import -> General -> Existing Projects into Workspace -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA мы двойным нажатием ЛКМ открываем файл `.ipr`. Загрузку скриптов Gradle нужно пропустить (`skip`). Когда инициализация закончится, крайне рекомендуется в меню `File -> Manage IDE Settings` конвертировать проект `.ipr` в `Directory-based format`, иначе багов и зависаний не миновать.
* Чтобы запустить мод из среды, используйте следующий подход.
  * В случае IntelliJ IDEA у нас уже сгенерированы сверху два варианта запуска, клиент и сервер. Сервер не работает, это норма. Клиент зачастую запускается с недостаточным количеством памяти. Это можно исправить, нажав на название запуска, а затем на `Edit Configurations`. Меняем `1024` на `2048` (как минимум).
  * В случае Eclipse IDE мы должны самостоятельно создать новую конфигурацию запуска. Это делается возле зелёного кружочка запуска на верхней панели - там есть чёрный треугольник, при нажатии на который можно увидеть `Run Configurations`. Нажимаем, затем выбираем слева `Java Application` и жмём сверху слева на белый документ. Появляется ненастроенный запуск. Настраиваем его.
    * В первой вкладке (сверху) указываем проект - это папка, для которой мы создаём запуски.
    * В первой вкладке (ниже) указываем файл входа - это `GradleStart`.
    * Во вкладке `Arguments` (сверху) выделяем память: `-Xincgc -Xmx2G -Xms2G`.
    * Во вкладке `Arguments` (снизу) указываем рабочую папку (где будут миры майнкрафта и прочие файлы игры). Например, создайте в скачанном репозитории папку `run` и укажите её, как рабочую.
    * Сохраняем.
* Чтобы скомпилировать мод в jar-файл, используйте следующий подход.
  * В случае Eclipse IDE откройте консоль Windows в папке среды и введите `gradlew build`. Альтернатива - создайте файл `build.bat`, откройте его блокнотом, впишите туда команду `gradlew build`, сохраните, запустите двойным нажатием ЛКМ.
  * В случае IntelliJ IDEA можно применить способ Eclipse, но есть и более красивый способ. Создайте собственный Gradle Task с командой `build` на вашем проекте и выполните его. Как это сделать:
    * Нажмите на любой из уже сгенерированных запусков.
	* Затем нажмите на `Edit Configurations`.
	* Слева сверху жмёте плюсик и затем дважды нажимаете ЛКМ по `Gradle` в появившемся меню.
	* Под словом `Run` пишете `build`.
	* Сохраняете снизу, нажав на "ОК".
	* Для компиляции выбираете тот запуск, который вы только что создали, и запускаете его зелёной кнопкой запуска (треугольник).
* После того, как вы запустите сборку одним из способов выше, произойдёт компиляция, а ваш мод появится в папке `среда_разработки/build/libs`.

<h3> Версии 1.12.2 и новее </h3>

Эти версии вышли недавно и они уже рассчитаны на упрощённый запуск без костылей.

* Для начала, мы импортируем проект Gradle в среду.
  * В случае Eclipse IDE мы импортируем всю папку версии как "существующий Gradle-проект": `File -> Import -> Gradle -> Existing Gradle Project -> Next -> [Выбираете папку] -> Finish`.
  * В случае IntelliJ IDEA мы открываем всю папку версии как папку проекта. Это можно сделать, открыв IDE и выбрав `File -> Open -> [Выбираете папку]`.
* Чтобы запустить мод из среды, мы должны сгенерировать запуски.
  * В случае Eclipse IDE мы можем открыть поиск (лупа сверху справа) и ввести там `Gradle`, впоследствии нажав на предложенный ответ `Gradle Tasks`. Снизу выбираем `Forgegradle Runs -> genEclipseRuns`.
  * В случае IntelliJ IDEA у нас есть значок слона сверху справа, нажимая на него, мы попадаем в меню Gradle. Нас там интересует `Forgegradle Runs -> genIntellijRuns`.
  * Есть и другие способы. Например, открыть консоль Windows в папке версии и ввести там `gradlew genEclipseRuns/genIntellijRuns`.
  * Если есть проблемы с открытием консоли, можно создать файл с расширением .bat в папке версии, открыть его при помощи блокнота и написать внутри него `gradlew genEclipseRuns/genIntellijRuns`, после чего запускать процесс двойным тыком.
* После генерации запусков вы можете применять их.
  * В Eclipse IDE нужно сверху нажать на чёрный треугольник возле зелёного треугольника запуска, а затем нажать на нужный запуск.
  * В IntelliJ IDEA нужно сверху нажать на название запуска, затем в открывшемся списке выбрать нужный и нажать на зелёный треугольник справа от него.
* Чтобы скомпилировать мод, используйте Gradle Task `build` из категории build. Аналогично способу генерации запусков, вы можете использовать консоль или .bat-файл.
* После того, как вы запустите сборку одним из способов выше, произойдёт компиляция, а ваш мод появится в папке `среда_разработки/build/libs`.

<h2> Примечания </h2>

Вы можете всё сделать правильно, но при этом ничего не будет работать. Это бывает редко, но, тем не менее, бывает.

* Eclipse иногда, ввиду плохого интернета, может повредить скачиваемый файл и настройка среды сорвётся. И потом никогда не починится. Придётся всё сделать через IntelliJ IDEA, а уже потом импортировать среду в Eclipse.
* Версия 1.12.2 может не запускаться или не иметь текстур в IntelliJ IDEA, но в Eclipse всё будет нормально.
